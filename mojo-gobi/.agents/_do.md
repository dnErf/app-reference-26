Optimize compaction strategy for performance and space efficiency